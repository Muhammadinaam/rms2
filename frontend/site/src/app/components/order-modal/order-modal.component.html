<div class="modal {{ visibility == true ? 'is-active' : '' }}">
    <div class="modal-background"></div>
    <div class="modal-card">
      <header class="modal-card-head is-radiusless">
        <p class="modal-card-title">Order</p>
        <button class="delete" aria-label="close" (click)="setModalVisibility(false)"></button>
      </header>
      <section class="modal-card-body">
        
        <!-- {{order|json}} -->
        <div *ngIf="order.items.length <= 0">
          <p class="title is-6 has-text-centered">Order is Empty. Please add items to order</p>
        </div>
        <div *ngIf="order.items.length > 0">
          <p class="title is-4">Items</p>

          <div *ngFor="let item of order.items; let item_index = index;" class="notification">
            <button class="delete" (click)="deleteItem(item_index)"></button>
            <table class="table is-fullwidth">
              <tr>
                <td><b>{{item.name}}</b></td>
                <td>{{item.price | currency:currencyCode}}</td>
              </tr>

              <ng-container *ngFor="let option of item.options">
                <tr *ngIf="option.options_items.length > 1">
                  <td>{{option.name}}</td>
                  <td></td>
                </tr>
                <tr *ngFor="let option_item of option.options_items">
                  <td class="{{option.options_items.length > 1 ? 'left-indented' : '' }}">
                    {{ option.options_items.length > 1 ? option_item.name : option.name + ': ' + option_item.name }}
                  </td>
                  <td>{{option_item.price | currency:currencyCode }}</td>
                </tr>

              </ng-container>
              <tr>
                <td><b>Price</b></td>
                <td><b>{{item.item_price_with_options | currency:currencyCode }}</b></td>
              </tr>
              <tr>
                <td><b>Quantity</b></td>
                <td><b>{{item.quantity}}</b></td>
              </tr>
              <tr>
                <td><b>Sub Total</b></td>
                <td><b>{{item.item_price_with_options * item.quantity | currency:currencyCode }}</b></td>
              </tr>
            </table>
          </div>





          <p class="title is-4">Amounts</p>
          <table class="table is-fullwidth">
            <tr>
              <td>Order Amount</td>
              <td>{{order.order_amount_before_discount | currency:currencyCode}}</td>
            </tr>
            <tr>
              <td>Discount ({{order.discount_percent}}%)</td>
              <td>{{order.discount_amount | currency:currencyCode}}</td>
            </tr>
            <tr>
              <td>Sales Tax / Vat ({{order.sales_tax_percent}}%)</td>
              <td>{{order.sales_tax_amount | currency:currencyCode}}</td>
            </tr>
            <tr>
              <td>Delivery Charges</td>
              <td>{{order.delivery_charges | currency:currencyCode}}</td>
            </tr>
            <tr class="is-selected">
              <td>Total Payable</td>
              <td>
                {{order.order_amount_before_discount - order.discount_amount + order.sales_tax_amount + order.delivery_charges | currency:currencyCode }}
              </td>
            </tr>
          </table>

          <hr>

          <p class="title is-4">Customer Information</p>

          <div class="field">
            <label class="label">Name</label>
            <div class="control">
              <input class="input" type="text" [(ngModel)]="order.customer_name">
            </div>
          </div>
          <div class="field">
            <label class="label">Address</label>
            <div class="control">
              <input class="input" type="text" [(ngModel)]="order.customer_address">
            </div>
          </div>
          <div class="field">
            <label class="label">Zipcode</label>
            <div class="control">
              <input class="input" type="text" [(ngModel)]="order.customer_zipcode">
            </div>
          </div>
          <div class="field">
            <label class="label">Phone</label>
            <div class="control">
              <input class="input" type="text" [(ngModel)]="order.customer_phone">
            </div>
          </div>

          <div class="buttons is-centered">
            <button class="button is-success {{ loading ? 'is-loading' : '' }}" (click)="saveOrder()" [disabled]="loading">
              Save Order
            </button>
          </div>
          
        </div>
  
      </section>
    </div>
  </div>